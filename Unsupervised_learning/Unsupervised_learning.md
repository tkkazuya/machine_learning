# **教師なし学習（Unsupervised Learning）**

1. 主成分分析
2. k-平均法
3. 補足
---

## **1. 主成分分析（Principal Component Analysis）**

### **主成分分析**とは：
- データの次元削減（Dimensionality reduction）手法の一つ。
- 一般にPCAと呼ばれることが多い。（気がする）
- 1. 可視化 2. 高次元（多次元）データの低次元化に使用される
  - データを見つけたときに"とりあえずやってみること"の一つ（EDAの後？）

- 実測値（観測値）の分散を使用して主成分を求める。

### **主成分分析**の流れ：

- データの標準化
- 分散共分散行列の計算
- 固有値・固有ベクトルの計算
- 主成分の選択


主成分分析の流れ、目的等参考：<http://ibis.t.u-tokyo.ac.jp/suzuki/lecture/2015/dataanalysis/L7.pdf>
- 主成分分析は分野によって、呼び名が異なる。
  - ex:製造業における**ホテリング理論**

#### ホテリング理論（Hotelling's T-squared test）：
- 統計学の手法の一つで、異常検知にも応用される。
- 多変量データセットにおいて異常を検出するために使用されることが多い。
- 主成分分析（PCA）などの次元削減手法を用いてデータを低次元空間に射影し、その空間上で異常な振る舞いを検出する

**$T^2統計量$と$Q$統計量**

- $T^2$統計量（Hotelling's $T^2$統計量）
  - 主要な主成分のみを分散1に規格化して、原点からの距離の2乗
- $Q$統計量（二乗予測誤差：Squared Prediction Error）
  - 主要な主成分で張られる部分空間からの距離（予測誤差）の二乗


イメージ：<https://orist.jp/content/files/technicalsheet/21-26.pdf
定義：<https://www.chowagiken.co.jp/blog/anomalydetection_introduction>
特長：<https://datachemeng.com/t2qstatistics/>

--- 
## **2. k-平均法（k-means）**

- k平均法 (k-means) はクラスタリングと呼ばれる手法に当たり、データを複数のクラスター（グループ）に分けて大まかな特徴を捉える際に使用する。

可視化：<http://tech.nitoyon.com/ja/blog/2009/04/09/kmeans-visualise/>

**k平均法の流れ**

1. 人間側がクラスター（グループ）の数を決める
2. ランダムに振られた点（重心）から近いものをクラスターとする
3. 紐づいたクラスターとの距離を元に重心を移動させる
4. 上記の３つを重心が動かなくなるまで繰り返す。

- コンビニエンスストアの購買データを元にしたクラスタリング活用を行う。


**クラスター数の決め方**

- エルボー法
- シルエット法

エルボー法は使わない方がいい？（二次元データの場合）：https://tjo.hatenablog.com/entry/2023/01/27/174640

クラスター数の決め方：https://qiita.com/deaikei/items/11a10fde5bb47a2cf2c2


---
## 3. 補足

今回の２つの手法は別々のものとして紹介されたが、多次元データの分析の際等に以下のように組み合わせることも可能。
1. PCAで２（n）次元まで次元削減
2. k-meansによって2次元（n次元）でクラスターに分類
